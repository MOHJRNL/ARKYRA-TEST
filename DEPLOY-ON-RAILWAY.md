# Deploying ARKYRA on Railway

This guide provides step-by-step instructions for deploying the ARKYRA platform to a staging or testing environment on Railway. Railway is an excellent platform for easy, Git-based deployments.

**Estimated Time:** 15-20 minutes
**Best For:** Staging, team testing, client demos.

---

## Prerequisites

1.  **A Railway Account:** [Sign up here](https://railway.app).
2.  **Your ARKYRA GitHub Repository:** The one we created (`https://github.com/MOHJRNL/ARKYRA`).

---

## Step 1: Create a New Project on Railway

1.  Log in to your Railway dashboard.
2.  Click **"New Project"**.
3.  Select **"Deploy from GitHub repo"**.
4.  Configure the Railway app with your GitHub account and select the **`MOHJRNL/ARKYRA`** repository.

---

## Step 2: Configure the Services

Railway will automatically detect the `docker-compose.arkyra.yaml` file and ask you to configure the services. You will need to set up each service defined in the compose file.

For each service (e.g., `arkyra-backend`, `arkyra-frontend`), you will need to:

1.  **Set the Build Method:** Choose **"Dockerfile"**.
2.  **Point to the Dockerfile:**
    *   For `arkyra-backend`, the path is `./Dockerfile.backend`.
    *   For `arkyra-frontend`, the path is `./Dockerfile.frontend`.
    *   And so on for each service.

---

## Step 3: Add a Database and Redis

Instead of running PostgreSQL and Redis from the Docker Compose file, it is better to use Railway's managed services.

1.  In your Railway project, click **"New"** -> **"Database"** -> **"PostgreSQL"**.
2.  Click **"New"** -> **"Database"** -> **"Redis"**.

Railway will automatically provision these services and provide you with connection strings in the form of environment variables (e.g., `DATABASE_URL`, `REDIS_URL`).

---

## Step 4: Configure Environment Variables

This is the most critical step. You need to provide all the necessary environment variables for your application to run.

1.  Go to the **"Variables"** tab for your project.
2.  Click on **"Raw Editor"**.
3.  Copy the contents of your local `.env.arkyra.example` file and paste them here.

**Important Adjustments:**

*   **Database and Redis URLs:** Railway provides these automatically. Make sure the variable names in Railway match what the application expects (`DATABASE_URL`, `REDIS_URL`). You can reference them from the managed services.
*   **`FRONTEND_URL` and `NEXT_PUBLIC_BACKEND_URL`:** Railway will generate public URLs for your frontend and backend services. Go to the **"Settings"** tab for each service and find its public domain. Use these domains in your environment variables.
*   **API Keys:** Add all your secret keys for social media and AI providers here.

---

## Step 5: Expose Ports and Deploy

1.  For the `arkyra-frontend` and `arkyra-nginx` services, go to the **"Settings"** tab and click **"Generate Domain"** to make them publicly accessible.
2.  Railway will automatically trigger a deployment after you link the repository. You can monitor the build and deployment logs in the **"Deployments"** tab.

---

## Step 6: Run Database Migrations

Once the deployment is successful, you need to run the database migrations.

1.  Connect to the `arkyra-backend` service's shell from the Railway dashboard.
2.  Run the migration command:

    ```bash
    pnpm run prisma-db-push
    ```

---

## Step 7: Access Your Staging Environment

Your ARKYRA staging environment is now live at the public URL generated by Railway for your `arkyra-frontend` service.

## Automatic Deployments

By default, Railway will automatically redeploy your application every time you push a new commit to your main branch. This makes it incredibly easy to test new features.

This setup provides a fast and efficient way to maintain a staging environment for the ARKYRA project.
